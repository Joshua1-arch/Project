<!DOCTYPE html>
<html>
<head>
	<title>Personal Portal</title>
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="style.css"> -->
	<link rel="stylesheet" type="text/css" href="bootstrap-5.0.0-beta3-dist/css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="shortcut icon" type="text/css" href="download.png">
		
	</style>
</head>
<body >
	<header>
		<!-- <p class="h3 text-center text-uppercase">Excellence Bank of Nigeria</p> -->
		<nav class="nav-bar" style="background-color: black" style="height: 100px">
			<ul class="nav">
				<!-- <input type="search" placeholder="Search" class="m-2 bg-warning" name=""> -->
				<!-- <li class="nav-item"><a class="nav-link link-info" href="signUp.html">Sign Up</a></li>
				<li class="nav-item"><a href="signIn.html" class="nav-link link-info">Sign In</a></li> -->
				<li class="nav-item"><a href="#" class="nav-link  active" >Personal Portal</a></li>
				<li class="nav-item"><a href="admin.html" class="nav-link link-info">Admin</a></li>
				<li class="nav-item"><a href="Home.html" class="nav-link link-info">Logout</a></li>
				
			<li><button class="btn btn-primary  m-1" style="background-color: black; border-color:black" onclick="showBalance()">Check Balance</button></li>
			<li><button class="btn btn-primary  m-1" style="background-color: black; border-color:black" onclick="withdraw()">Transfer</button></li>
			<li><button class="btn btn-primary m-1" style="background-color: black; border-color:black">Deposit</button></li>
			<li><button class="btn btn-primary  m-1" style="background-color: black; border-color:black" onclick="Transfer()">Withdraw</button></li>
			<li>
				<button class="btn btn-primary m-1" style="background-color: black; border-color:black" onclick="ShowTransactions()">
			Account transactions
		</button>
			</li>
			<!-- <li><button class="btn btn-primary m-2" style="background-color: black"><a href="game.html">Game</a></button></li> -->
			</ul>
		</nav>
	</header>
	<div class="container w-25" style="background-color: black">
		<img src="no-profile-image.png" style="width: 100px">
			<div id="userProfileDetails" style="display: none;" class="text-white">
				<h1>
					Users Profile
				</h1>
			</div>	
		<br>
		<div class="text-white">
	
		Name: <div id="showingAccount1" class="text-white" style="display: none;"></div>
	
		<br> 
	
		Account No: <div id="showingAccount" class="text-white" style="display: none"></div>
	
		<br> 

		<button class="btn btn-primary" onclick="editDetails()">
			Edit Details
		</button>
		
		</div>
	</div>
	<!-- <main>
		<ul>
			
		</ul> -->
		
		<center>
			<!-- <li><button class="btn btn-danger text-white m-2" onclick="editDetails()">Edit Details</button></li> -->
			<div id="bank" class="text-light"></div>
		</center>
		<center>
		<div id="editDets">
		<div >
			<form >
  <div class="mb-1 form-text">
    <label  class="form-label text-white" sty>First Name</label>
    <input class="form-control  w-25" id="fName" placeholder="Required First Name" required>
    </div>
  </div>

  <div class="form-text mb-1">
    <label class="form-input-label text-white" sty>Lastname</label>
    <input type="text" class="form-control  w-25" placeholder="Required Last Name" id="lName" required>
  </div>

  <div class="form-text mb-1">
    <label class="form-text-label text-white" sty>Phone Number</label>
    <input type="text" class="form-control  w-25" placeholder="Phone Number" id="phone" required>
  </div>


  <div class="form-email mb-1">
    <label class="form-email-label text-white" for="validationEmail"sty>Email</label>
    <input type="email" class="form-control  w-25" placeholder="abcd@info.com" id="email" required>
  </div>
  
  <div class="form-password mb-1">
    <label class="form-password-label text-white" sty>Pin</label>
    <input type="password" class="form-control  w-25" placeholder="Eg. 1234" id="pin" required>
  </div>
  <label for="Account" class="text-white">Account Number</label>
  <input type="text" id="accNumber">
  <br>
  <input type="text" id="amount">
  <br>
    <button type="button" class="btn btn-success" onclick="saveEdit()">Save</button>
    <button type="button" class="btn btn-danger" onclick="clearDets()">Delete Account</button>
</form>
</div>
		</div>
			</div>
	</center>

	<script type="text/javascript">
		editDets.style.display = 'none';
		amount.style.display = 'none';
		let allClients = [];
		existing = JSON.parse(localStorage.allCustomers);
		allClients = existing;
		// console.log(allClients)
		for (var i = 0; i < allClients.length; i++) {
			if (JSON.parse(localStorage.login) == i) {
				alert('Welcome, ' + allClients[i].firstName)
				
			}
			userProfileDetails.style.display="block"
			showingAccount.style.display="block"
				showingAccount.innerHTML=allClients[i].accNo;
				showingAccount1.style.display="block"
				showingAccount1.innerHTML=allClients[i].firstName + " " + allClients[i].lastName;
		}

		function editDetails() {
			editDets.style.display = 'block';
			for (var i = 0; i < allClients.length; i++) {
				if (JSON.parse(localStorage.login) == i) {
					accNumber.disabled = true;
					fName.value = allClients[i].firstName;
					lName.value = allClients[i].lastName;
					phone.value = allClients[i].phoneNumber;
					email.value = allClients[i].mail;
					pin.value = allClients[i].uPin;
					accNumber.value = allClients[i].accNo;
					amount.value = allClients[i].amount;

				}
			}
		}

		function saveEdit() {
			
			edited = {};
			edited.firstName = fName.value;
			edited.lastName = lName.value;
			edited.phoneNumber = phone.value;
			edited.mail = email.value;
			edited.uPin = pin.value;
			edited.accNo = accNumber.value;
			edited.amount = amount.value;
			for (var i = 0; i < allClients.length; i++) {
				if (edited.phoneNumber == allClients[i].phoneNumber && JSON.parse(localStorage.login) != i) {
					alert('Phone number already exist, please try another phone number')
					return
				} else {
					allClients.splice(JSON.parse(localStorage.login), 1, edited)
					localStorage.allCustomers = JSON.stringify(allClients)
					alert('Edit successful')
					return
				}
			}
			
		}

		function clearDets() {
					allClients.splice(JSON.parse(localStorage.login), 1);
					localStorage.allCustomers = JSON.stringify(allClients)
					alert('Account Deleted successfully');
					window.location.href = 'index.html'
		}

		function showBalance() {
			for (var i = 0; i < allClients.length; i++) {
				if (JSON.parse(localStorage.login) == i) {
					bank.innerHTML = 'Dear, ' +allClients[i].firstName + ' your account balance is ' + allClients[i].amount;
				}
			}
		}

		function withdraw() {
			newAmount = {}
			withdrawAmount = prompt('How much do you wish to withdraw')
			user = prompt('Enter your account pin')
			for (var i = 0; i < allClients.length; i++) {
				if (JSON.parse(localStorage.login) == i && allClients[i].uPin == user) {
					newAmount.firstName = allClients[i].firstName;
					newAmount.lastName = allClients[i].lastName;
					newAmount.phoneNumber = allClients[i].phoneNumber;
					newAmount.mail = allClients[i].mail;
					newAmount.uPin = allClients[i].uPin;
					newAmount.accNo = allClients[i].accNo
					newAmount.amount = eval(allClients[i].amount - withdrawAmount)
					bank.innerHTML = 'Your new balance is ' + newAmount.amount;
					// allClients[i].amount = newAmount.amount;
					allClients.splice(JSON.parse(localStorage.login), 1, newAmount)
					localStorage.allCustomers = JSON.stringify(allClients)
					return
				}
			}
		}
		function Transfer() {
			newAmount = {}
			withdrawAmount = prompt('How much do you wish to withdraw')
			user = prompt('Enter your account pin')
			benefic=prompt('Enter account')
			for (var i = 0; i < allClients.length; i++) {
				if (JSON.parse(localStorage.login) == i && allClients[i].uPin == user) {
					newAmount.firstName = allClients[i].firstName;
					newAmount.lastName = allClients[i].lastName;
					newAmount.phoneNumber = allClients[i].phoneNumber;
					newAmount.mail = allClients[i].mail;
					newAmount.uPin = allClients[i].uPin;
					newAmount.accNo = allClients[i].accNo
					newAmount.amount = eval(allClients[i].amount - withdrawAmount)
					bank.innerHTML = 'Your new balance is ' + newAmount.amount;
					newAmount.amount=eval()
					// allClients[i].amount = newAmount.amount;
					allClients.splice(JSON.parse(localStorage.login), 1, newAmount)
					localStorage.allCustomers = JSON.stringify(allClients)
					return
				}
			}
		}
			function ShowTransactions(){
				// alert('hello')
				trans.innerHTML=newAmount.amount
			}
	</script>

	<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script> -->
</body>
</html>